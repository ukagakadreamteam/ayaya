
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">


<head profile="http://purl.org/net/ns/metaprof">
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <meta http-equiv="content-style-type" content="text/css" />

 <title>チュートリアル/3.変数を使ってみよう - AYAYA/03</title>
 <link rel="stylesheet" href="skin/default.css" type="text/css" media="screen" charset="UTF-8" />
 <link rel="stylesheet" href="skin/print.css" type="text/css" media="print" charset="UTF-8" />
 <link rel="stylesheet" href="/svgd/table.css" type="text/css" />
 <link rel="alternate" type="application/rss+xml" title="RSS" href="index.php?cmd=mixirss&amp;ver=0.91" /> 
 <script type="text/javascript">
 <!--
 // -->
 IMAGE_DIR = 'image/';
 SKIN_DIR = 'skin/';
 </script>
<!-- <script type="text/javascript" src="skin/lang/.js"></script> -->
<script type="text/javascript" src="skin/default.js"></script>
<!-- <script type="text/javascript" src="skin/ajax/textloader.js"></script> -->
<!-- <script type="text/javascript" src="skin/ajax/glossary.js"></script> -->
 <script type="text/javascript" src="skin/tzCalculation_LocalTimeZone.js"></script>

</head>

<body>

<div id="interface_content">
   <div id="body"><h2 id="content_1_0">チュートリアル3.変数を使ってみよう<a class="anchor_super" id="kab82973" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#kab82973" style="user-select:none;">&dagger;</a></h2>
<div class="contents">
<a id="contents_1"></a>
<ul class="list1 list-indent1"><li><a href="#kab82973">チュートリアル3.変数を使ってみよう</a>
<ul class="list2 list-indent1"><li><a href="#f03ef3ff">文字列と数値</a>
<ul class="list3 list-indent1"><li><a href="#h613bbda">グローバルとローカル</a></li>
<li><a href="#k56de4c3">ローカル変数の寿命</a></li></ul></li>
<li><a href="#y8e6b659">実際に変数を使ってみよう</a>
<ul class="list3 list-indent1"><li><a href="#r2dc790f">準備</a></li>
<li><a href="#b8be2da0">SHIORI Eventから生まれてくる変数を使ってみよう</a></li>
<li><a href="#cebbd6ed">オリジナル変数を作ってみよう</a></li>
<li><a href="#j7856679">変数の計算をしてみよう</a></li>
<li><a href="#p75443f3">変数をちゃんと保存されているかどうか確認</a></li></ul></li></ul></li></ul>
</div>

<p>「変数」とは文字列や数値を入れる、入れ物や箱のようなもの。<br />
ゴーストでいうと「ユーザー名」「起動回数」「起動時間」「好感度」なんかが変数です。<br />
YAYAの変数はいろんな種類があります。<br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h3 id="content_1_1">文字列と数値<a class="anchor_super" id="f03ef3ff" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#f03ef3ff" style="user-select:none;">&dagger;</a></h3>
<p>変数には「文字列」と「数値」の二種類があります。（正確には整数、実数、文字列の3種類）<br /></p>
<pre>変数 = 1</pre>
<p>こう書くと変数の中身は数値の「1」</p>
<pre>変数 = &quot;1&quot;</pre>
<p>こうやって&quot;　&quot;か'　'でくくって代入すると文字列の「1」が入ります。<br />
こんな風に変数に中身を入れることを「代入」と言います。<br />
<br />
全角の「１」「２」「３」…は数値になることはできません。文字列扱いになります。<strong>文字列型変数だと数値として比較や計算ができません。</strong><br />
例えば数字の数値「1」と「2」で足し算すると結果は「3」になりますが、文字列の「1」と「2」を足すと1と2がくっついて「12」になってしまいます。他にも色々違いがありますので注意してください。<br />
<br />
ちなみに変数はYAYAのシステム関数を使っていつでも好きな時に文字列←→数値に変更できます。安心。<br /></p>
<ul class="list1 list-indent1"><li>変数を文字列変数にする
<pre>変数 = TOSTR(変数)</pre></li></ul>
<ul class="list1 list-indent1"><li>変数を数値変数にする
<pre>変数 = TOINT(変数)</pre></li></ul>
<p>自動的に整数、実数、文字列どれなのか判断して変換してくれる<span class="noexists"><a href="index.php?cmd=edit&amp;page=TOAUTO&amp;refer=%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%2F3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86">TOAUTO</a></span>なんてのもあります。<br />
（システム関数についての詳しい説明はのちほど）</p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_2">グローバルとローカル<a class="anchor_super" id="h613bbda" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#h613bbda" style="user-select:none;">&dagger;</a></h4>
<pre>_変数名</pre>
<p>名前の頭に「_」がついてるとローカル変数</p>
<pre>変数名</pre>
<p>ついてないとグローバル変数です。<br />
<br />
おおざっぱに言うと「すぐ消えてしまう一時的なもの」がローカル変数、「削除しない限りずっと残る」のがグローバル変数です。<br />
動作やセーブデータを軽くするため「ユーザー名」や「好感度」などずっと残しておかないといけない変数以外はなるべくローカル変数を使うのをお勧めします。<br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_3">ローカル変数の寿命<a class="anchor_super" id="k56de4c3" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#k56de4c3" style="user-select:none;">&dagger;</a></h4>
<p>（この辺ややこしいので、わかりづらかったら今は飛ばして後で気になった時読んでみてください）<br /></p>
<p>で、ローカル変数がどれぐらいの期間使えるのかというと、<br />
「現在の{ }内、およびそれより深い入れ子階層のみで使用できる。寿命は該当する{ }を抜けるところまで。」<br />
です。（マニュアルより引用）<br />
<br />
言葉では説明しづらいので一例をだしてみると</p>
<pre>ローカル変数テスト {
　　{
　　_変数 = 1
　　}
結果 = _変数
}</pre>
<p>こう書くと「_変数」が深い階層から浅い階層に移った時に消えてしまうので「結果」の中身も空になってしまいますが</p>
<pre>ローカル変数テスト {
_変数 = &quot;&quot;
　　{
　　_変数 = 1
　　}
結果 = _変数
}</pre>
<p>こうすれば「_変数」は浅い階層→深い階層→浅い階層…と、最初に浅い階層にいた経験があるので深い階層から浅い階層に移動しても消えずに残り、「結果」の中身は1です。<br />
最初に「_変数」が生まれたところが「結果=_変数」と同じ（またはもっと浅い）階層かどうかがポイント。
<br />
つまりローカル変数を長生きさせたい時は最初に一番浅い階層で「_○○=&quot;&quot;」などの一行を書いておけばOK。<br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h3 id="content_1_4">実際に変数を使ってみよう<a class="anchor_super" id="y8e6b659" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#y8e6b659" style="user-select:none;">&dagger;</a></h3>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_5">準備<a class="anchor_super" id="r2dc790f" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#r2dc790f" style="user-select:none;">&dagger;</a></h4>
<p>「dic_main.dic」を開き</p>
<pre class="aya">//クリックされたら「MouseDoubleClick_(キャラ番号)(当たり判定識別子)」イベントにジャンプ
OnMouseDoubleClick{EVAL(&quot;MouseDoubleClick_%(reference[3])%(reference[4])&quot;)}</pre>
<p>この「<span class="noexists"><a href="index.php?cmd=edit&amp;page=OnMouseDouble&amp;refer=%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%2F3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86">OnMouseDouble</a></span>～」の行の左端に「//」を入れ、コメントアウトしてください。<br />
そして、代わりに以下の3行をどこかに書きましょう。</p>
<pre class="aya">OnMouseDoubleClick {
	&quot;\0\s[0]変数の実験をやるよー！\e&quot;
}</pre>
<p>このイベントは「ゴーストが左ダブルクリックされた」時に起こるイベントです。<br />
一般的なゴーストだとつつかれ反応をしたり、メニューが出てくるときが事が多いですね。</p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_6">SHIORI Eventから生まれてくる変数を使ってみよう<a class="anchor_super" id="b8be2da0" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#b8be2da0" style="user-select:none;">&dagger;</a></h4>
<p>「<span class="noexists"><a href="index.php?cmd=edit&amp;page=OnMouseDoubleClick&amp;refer=%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%2F3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86">OnMouseDoubleClick</a></span>」イベントが起きると「reference[0]」「reference[1]」…といった変数が自動的に生まれてきます。<br />
どの変数がどんな意味なのかは以前にも紹介した<a href="http://crow.aqrs.jp/reference/all/Shiori/index.html" rel="nofollow">CROW・SSPリファレンス - Shiori</a>に書いてあります。
（ここで「Reference0」と書いてある変数はYAYAでは「reference[0]」と書きます）<br />
<br />
試しに「クリックされたキャラの番号」が入ってるreference[3]をトーク中に入れてみましょう。<br /></p>
<pre class="aya">OnMouseDoubleClick {
	&quot;\0\s[0]変数の実験をやるよー！\n\n&quot;
	--
	reference[3]
	--
	&quot;番のキャラがつつかれたよ！\e&quot;
}</pre>
<p>単純に&quot;　&quot;や'　'で囲まないと変数の中身が展開されてトークになります。<br />
シンプル！<br />
メインキャラ（0番キャラ）とサブキャラ（1番キャラ）をダブルクリックしてみて、ちゃんと動いてるかどうか確認してみてください。<br />
<br />
この書き方じゃわかりづらい！書きづらいよ！…って時は<br /></p>
<pre class="aya">OnMouseDoubleClick {
	&quot;\0\s[0]変数の実験をやるよー！\n\n&amp;(reference[3])番のキャラがつつかれたよ！\e&quot;
}</pre>
<p>こんな書き方でもOK！<br />
<strong>「&quot;　&quot;」で囲まれた中で変数を使うときは「&amp;(変数名)」と書きましょう。</strong><br />
ちなみに「&quot;　&quot;」ではなく「'　'」で囲むと変数が展開されず、そのまま表示されます。</p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_7">オリジナル変数を作ってみよう<a class="anchor_super" id="cebbd6ed" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#cebbd6ed" style="user-select:none;">&dagger;</a></h4>
<p>ゴーストにプレゼントをあげてみましょう。<br />
「プレゼント」という変数に「花束」という文字を入れる時は、最初に説明した「変数 = 変数に代入したいもの」を「{　}」の中に書きます。</p>
<pre class="aya">OnMouseDoubleClick
 {
 プレゼント = &quot;花束&quot;
 
 　&quot;\0\s[0]わーい「%(プレゼント)」ありがとう！\e&quot;
 }</pre>
<pre class="aya">【ここ】プレゼント【ここ】=【ここ】1【ここ】</pre>
<p>【ここ】の部分には空白やタブを入れても構いません。<br />
演算記号（=や+といった記号のこと）は半角しか使えません。<br />
見やすくするため演算記号の右と左に半角空白を入れる人が多いようです。<br />
<br />
この例だと変数に入れる中身「花束」は数値じゃないので&quot;　&quot;か'　'でくくります。トークを書くときと同じですね。<br /></p>
<pre class="aya">OnMouseDoubleClick
 {
 プレゼント = 花束
 
 &quot;\0\s[0]わーい「%(プレゼント)」ありがとう！\e&quot;
 }</pre>
<p>うっかりこう書いてしまうと「プレゼント」の中身はからっぽになってしまいます。<br />
なぜかというと、<strong>YAYAは「&quot;花束&quot;」ではなく「花束」だけだと「『花束』という名前の変数」と解釈してしまうからです</strong>。<br />
そのため「『プレゼント』という変数に『花束』という変数の中身を入れましたよ～」、という意味に誤解され、<br />
「花束」という変数は存在してないため中身は空っぽになってしまう、という訳です。<br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_8">変数の計算をしてみよう<a class="anchor_super" id="j7856679" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#j7856679" style="user-select:none;">&dagger;</a></h4>
<p>数値型の変数の場合、計算もできます。</p>
<pre class="aya">OnMouseDoubleClick
 {
 好感度=好感度+1
 
 　&quot;\0\s[0]ユーザーさんだいすき！\n\n（好感度が「%(好感度)」になった！）\e&quot;
 }</pre>
<p>こっちもシンプル。<br /></p>
<p><br />
ちなみにこう省略して書く事もできます。</p>
<pre class="aya">OnMouseDoubleClick
 {
 好感度++
 
 　&quot;\0\s[0]ユーザーさんだいすき！\n\n（好感度が「%(好感度)」になった！）\e&quot;
 }</pre>
<p>「好感度++」は「好感度を1だけ増やしますよ」という意味で「好感度=好感度+1」と意味は同じです。<br />
「好感度--」だと1減ります。<br />
「好感度+=2」だと「好感度=好感度+2」と同じ、「好感度-=2」は「好感度=好感度-2」と同じです。<br />
そのほかYAYAで使える計算用の記号の説明はこのあたりに書いてあります。（専門用語多くてちょっとわかりにくいですが）<br /></p>
<ul class="list1 list-indent1"><li><a href="http://emily.shillest.net/ayaya/index.php?old%2FAYA%2F%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%2FV5%2F%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB#v84b1e7f" rel="nofollow">old/AYA/ドキュメント/V5/マニュアル</a></li></ul>
<p>文字同士の足し算もできます。</p>
<pre>プレゼント = &quot;花&quot; + &quot;束&quot;</pre>
<p>と書くと変数「プレゼント」の中身は「&quot;花束&quot;」となります。<br />
<br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h4 id="content_1_9">変数をちゃんと保存されているかどうか確認<a class="anchor_super" id="p75443f3" href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/3.%E5%A4%89%E6%95%B0%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%88%E3%81%86#p75443f3" style="user-select:none;">&dagger;</a></h4>
<p>ゴーストを一旦終了し、セーブデータファイル（yaya_variable.cfg）をテキストエディタで開いてみてください。<br />
上の例だったら<br /></p>
<pre>プレゼント,&quot;花束&quot;,,</pre>
<p>という一行があれば、保存成功！<br />
ちなみに数値型の変数の場合は<br /></p>
<pre>好感度,1,,</pre>
<p>こんな風に変数の中身の数字が&quot;　&quot;で囲まれてません。</p>
   
   	 	
	</div>
</div>




<table cellspacing=0 width=100%>
<tr><td id=footer>


<div id="lastmodified">
 Last modified on: 2014-01-03 (Friday) 12:00:41<span class="page_passage"></span></div>


<div id="related">
 Related pages: <a href="index.php?%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB/2.%E3%83%88%E3%83%BC%E3%82%AF%E3%82%92%E6%9B%B8%E3%81%84%E3%81%A6%E3%81%BF%E3%82%8B">チュートリアル/2.トークを書いてみる</a><span class="page_passage"></span></div>


</td></tr>
</table>

<div id="interface_footer"></div>

<script src="interface.js"></script>

</body>
</html>
