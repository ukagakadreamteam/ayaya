
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">


<head profile="http://purl.org/net/ns/metaprof">
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <meta http-equiv="content-style-type" content="text/css" />

 <title>Tips/テキストの幅を揃える - AYAYA/03</title>
 <link rel="stylesheet" href="skin/default.css" type="text/css" media="screen" charset="UTF-8" />
 <link rel="stylesheet" href="skin/print.css" type="text/css" media="print" charset="UTF-8" />
 <link rel="stylesheet" href="/svgd/table.css" type="text/css" />
 <link rel="alternate" type="application/rss+xml" title="RSS" href="index.php?cmd=mixirss&amp;ver=0.91" /> 
 <script type="text/javascript">
 <!--
 // -->
 IMAGE_DIR = 'image/';
 SKIN_DIR = 'skin/';
 </script>
<!-- <script type="text/javascript" src="skin/lang/.js"></script> -->
<script type="text/javascript" src="skin/default.js"></script>
<!-- <script type="text/javascript" src="skin/ajax/textloader.js"></script> -->
<!-- <script type="text/javascript" src="skin/ajax/glossary.js"></script> -->
 <script type="text/javascript" src="skin/tzCalculation_LocalTimeZone.js"></script>

</head>

<body>

<div id="interface_content">
   <div id="body"><h2 id="content_1_0">テキストの幅を揃える<a class="anchor_super" id="t447544f" href="index.php?Tips/%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%AE%E5%B9%85%E3%82%92%E6%8F%83%E3%81%88%E3%82%8B#t447544f" style="user-select:none;">&dagger;</a></h2>
<p>等幅フォントで使用してください。<br />
指定したバイト数をオーバーすればその分テキストを削ります。<br />
指定したバイト数まで足りない場合は余ったスペースを空白で埋めます。<br /></p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h3 id="content_1_1">使い方<a class="anchor_super" id="gf0af08a" href="index.php?Tips/%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%AE%E5%B9%85%E3%82%92%E6%8F%83%E3%81%88%E3%82%8B#gf0af08a" style="user-select:none;">&dagger;</a></h3>
<p>第一引数(_argv[0])　文字列<br />
第二引数(_argv[1])　揃えるバイト数<br /></p>
<pre>ARRANGETEXT(文字列,揃えるバイト数)</pre>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h3 id="content_1_2">ARRANGETEXT関数<a class="anchor_super" id="m31e77d5" href="index.php?Tips/%E3%83%86%E3%82%AD%E3%82%B9%E3%83%88%E3%81%AE%E5%B9%85%E3%82%92%E6%8F%83%E3%81%88%E3%82%8B#m31e77d5" style="user-select:none;">&dagger;</a></h3>
<pre class="aya">ARRANGETEXT
 {
 _sb=TOINT(_argv[1])
 _bytes=(GETSTRBYTES(_argv[0],0))
	if _bytes &lt; _sb {
	// 半角空白で埋める
	_space=(_sb-_bytes)
	_val=_argv[0]
	_lp=1
		while _lp &lt;= _space {
		_val=_val+' '
		_lp++
		}
	_val
	}
	elseif _bytes &gt; _sb {
	// 越えていれば削る
	_leng=_sb
	_loop=0
	_text=_argv[0]
	_byte=0
	_c=''
		while _byte&lt;_leng {
			_sub=(SUBSTR((_text),(_loop),1))
			_c=_c+_sub
			_byte=(GETSTRBYTES(_c,0))
			_loop++
				if _loop&gt;200 {break}
		}
	_re=RE_GREP(_c,'.$')
	_re=RE_GETSTR
			if (GETSTRBYTES((_c),0))&gt;_leng {
				_c=(RE_REPLACE(_c,'.$',''))+' '
				_c
			}
			else {_c}
	}
	else {_argv[0]}
 }</pre>
   
   	 	
	</div>
</div>




<table cellspacing=0 width=100%>
<tr><td id=footer>


<div id="lastmodified">
 Last modified on: 2009-05-02 (Saturday) 15:34:50<span class="page_passage"></span></div>




</td></tr>
</table>

<div id="interface_footer"></div>

<script src="interface.js"></script>

</body>
</html>
