
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">


<head profile="http://purl.org/net/ns/metaprof">
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <meta http-equiv="content-style-type" content="text/css" />

 <title>マニュアル/文法/4.演算 - AYAYA/03</title>
 <link rel="stylesheet" href="skin/default.css" type="text/css" media="screen" charset="UTF-8" />
 <link rel="stylesheet" href="skin/print.css" type="text/css" media="print" charset="UTF-8" />
 <link rel="stylesheet" href="/svgd/table.css" type="text/css" />
 <link rel="alternate" type="application/rss+xml" title="RSS" href="index.php?cmd=mixirss&amp;ver=0.91" /> 
 <script type="text/javascript">
 <!--
 // -->
 IMAGE_DIR = 'image/';
 SKIN_DIR = 'skin/';
 </script>
<!-- <script type="text/javascript" src="skin/lang/.js"></script> -->
<script type="text/javascript" src="skin/default.js"></script>
<!-- <script type="text/javascript" src="skin/ajax/textloader.js"></script> -->
<!-- <script type="text/javascript" src="skin/ajax/glossary.js"></script> -->
 <script type="text/javascript" src="skin/tzCalculation_LocalTimeZone.js"></script>

</head>

<body>

<div id="interface_header"></div>

<div id="interface_content">
   <div id="body"><ul class="navi">
 <li class="navi_left"><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/3.%E5%80%A4%E3%81%A8%E5%A4%89%E6%95%B0" title="マニュアル/文法/3.値と変数" class="link_page_passage">Prev</a></li>
 <li class="navi_right"><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/5.%E9%85%8D%E5%88%97" title="マニュアル/文法/5.配列" class="link_page_passage">Next</a></li>
 <li class="navi_none"><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95" class="link_page_passage">マニュアル/文法</a></li>
</ul>
<hr class="full_hr" />
<div class="contents">
<a id="contents_1"></a>
<ul class="list1 list-indent1"><li><a href="#q3ea1bb9">演算</a>
<ul class="list2 list-indent1"><li><a href="#v84b1e7f">基本</a></li>
<li><a href="#q7b01c6f">ブラケット( )による演算順序制御</a></li>
<li><a href="#a2371f18">フィードバック演算子&amp;</a></li></ul></li></ul>
</div>

<h2 id="content_1_0">演算<a class="anchor_super" id="q3ea1bb9" href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/4.%E6%BC%94%E7%AE%97#q3ea1bb9" style="user-select:none;">&dagger;</a></h2>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h3 id="content_1_1">基本<a class="anchor_super" id="v84b1e7f" href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/4.%E6%BC%94%E7%AE%97#v84b1e7f" style="user-select:none;">&dagger;</a></h3>
<p>C言語と同様の書式で四則演算、比較演算、代入、その他が可能です。<br />
演算の順序は演算子毎に重み付けされた演算優先度に基づいて決定されます。また、ブラケット( )で囲まれた部分は最優先で演算されます。
演算子の種類と演算優先度は以下の通りです。</p>
<pre>演算子　　　　　　　　　　　　　　　　　　　　　　意味　　　　　　　　　　優先度

( )　[ ]　　　　　　　　　　　　　　　　　　　　　ブラケット　　　　　　　高い
!　　　　　　　　　　　　　　　　　　　　　　　　 否定
++　--　　　　　　　　　　　　　　　　　　　　　　1を足す/1を引く
*　/　%　　　　　　　　　　　　　　　　　　　　　 乗除算、剰余
+　-　　　　　　　　　　　　　　　　　　　　　　　加減算
&amp;　　　　　　　　　　　　　　　　　　　　　　　　 フィードバック
==　!=　&gt;=　&lt;=　&gt;　&lt;　_in_　!_in_　　　　　　　　 比較
&amp;&amp;　　　　　　　　　　　　　　　　　　　　　　　　論理積
||　　　　　　　　　　　　　　　　　　　　　　　　論理和
=　:=　　　　　　　　　　　　　　　　　　　　　　 代入
+=　-=　*=　/=　%=　+:=　-:=　*:=　/:=　%:=　,=　 演算して代入
,       　　　　　　　　　　　　　　　　　　　　　汎用配列要素の列挙　　　低い</pre>
<p>コロン（&quot;:&quot;）付きの代入演算子は過去互換性を保持するために残されているもので、機能的にはコロン無しのものと同等です。<br /></p>
<p>*は単項演算子です。</p>
<p>ブラケット( )については次項で詳説します。<br />
カンマ演算子（&quot;,&quot;）、およびスクウェアブラケット[ ]については配列の項で詳説しています。<br />
フィードバック演算子&amp;については別項で詳説しています。
_in_と!_in_は文字列の包含チェックに使用する演算子です。</p>
<pre class="aya">foo
{
    &quot;or&quot; _in_ &quot;World&quot;
}</pre>
<p>_in_は左辺の文字列が右辺の文字列に含まれていれば1、含まれていなければ0を返します。!_in_はその逆です。<br />
上の関数fooは1を返します。</p>
<p>比較演算子は結果が真であれば整数1を、偽であれば0を返します。<br />
これらの演算子は文字列に対しても正しく機能します。値の大小は辞書順比較で決定されます。
論理の真偽は以下で判断されます。<br />
偽　整数0、実数0.0、空の文字列、空の汎用配列<br />
真　上記以外のすべて</p>
<p>代入でない演算は結果がそのまま出力となります。</p>
<pre class="aya">foo
{
    (3+2)*4
}</pre>
<p>この関数fooは20を出力します。</p>
<p>同じ優先度の演算子が連続している場合は、常に左から結合されます。</p>
<pre class="aya">1+2-3</pre>
<p>たとえば上の式は</p>
<ol class="list1 list-indent1"><li>1+2</li>
<li>3-3</li></ol>
<p>の順に計算されます。</p>
<pre class="aya">i = j = 10</pre>
<p>これはどうなるでしょう。C言語では代入演算子は右から結合されますから、iとjには10が代入されます。<br />
しかし文では結合は常に左からです。すなわち</p>
<ol class="list1 list-indent1"><li>i = j</li>
<li>j = 10</li></ol>
<p>の順に計算されます。したがって、iには10は入らないのです。</p>
<pre class="aya">i = (j = 10)</pre>
<p>これで i にも10が入るようになります。</p>
<p>演算対象の項の型が一致していない場合、結果の型は以下のようになります。</p>
<ul class="list1 list-indent1"><li>整数と実数の演算<br />
結果は実数となります。</li>
<li>整数/実数と文字列の加算<br />
数値は文字列に変換された後、もう一方の文字列に結合されます。</li>
<li>整数/実数と文字列の大小比較<br />
数値は文字列に変換された後、辞書順で大小比較されます。</li>
<li>整数/実数と文字列の演算（加算・大小比較以外）<br />
演算不能ですがエラーとはなりません。結果は空の文字列となります。</li></ul>
<p>ひとつの演算式内で型が混在していても構いません。<br />
必要に応じて、上記の法則により型変換が起こります。</p>
<pre class="aya">&quot;10+2は&quot; + (10+2) + &quot;です。&quot;</pre>
<p>最初に10+2が整数として計算され、結果12が得られます。残りはすべて文字列との加算ですから、12は文字列に変換され、文字列として結合されます。</p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h3 id="content_1_2">ブラケット( )による演算順序制御<a class="anchor_super" id="q7b01c6f" href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/4.%E6%BC%94%E7%AE%97#q7b01c6f" style="user-select:none;">&dagger;</a></h3>
<p>ブラケット( )で囲んだ部分は演算順序が最優先扱いになります。<br />
( ) はいくつでも重ねて指定可能で、深くなるほど優先度が上がります。
平たく言えば「かっこで囲んだところを先に計算する」ということです。これは当たり前の規則なのでいまさら大きく扱うまでもないのですが、
数式の書き方によってはなかなかややこしいこともあります。<br />
以下の例を見てください。</p>
<pre class="aya">answer = (_i = 10) + (2*(_i + 10))</pre>
<p>文の演算則をよく理解している人でないと、answerに何が代入されるかを正確に答えることは出来ないでしょう。<br />
answerには文字列の&quot;10&quot;が入ります。決して整数50ではありません。
最初に計算されるのはどこでしょう。ブラケットが一番深いところ、すなわち _i + 10 です。さて変数 _i はまだありません。したがってこれは空の文字列になります。となると、_i + 10 は文字列と整数の加算です。10は文字列に変換され、&quot;10&quot;となります。しかし次が整数との乗算なので、結局また空文字列になってしまいます。<br />
ここまで説明すれば結果が文字列の&quot;10&quot;になる理由は明白でしょう。
さて、こちらの意図ではまず_i = 10の代入を先にしてもらいたいわけです。<br />
このような場合、文では以下のようにブラケットを過剰に付与することで演算順序をコントロールします。</p>
<pre class="aya">answer = (((_i = 10))) + (2*(_i + 10))</pre>
<p>これで代入部分の優先度が一気に引き上げられました。今度は正しい結果が入るはずです。
なお、代入部分を囲むブラケットは2段で十分ではないかと思われるかも知れませんが、それも誤りです。ブラケット2段は_i + 10と同じ深さとなりますが、=と+では優先度が+のほうが高いのです。</p>

<div class="jumpmenu"><a href="#navigator">&uarr;</a></div><h3 id="content_1_3">フィードバック演算子&amp;<a class="anchor_super" id="a2371f18" href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/4.%E6%BC%94%E7%AE%97#a2371f18" style="user-select:none;">&dagger;</a></h3>
<p>フィードバック演算子&amp;は、他の演算子とは使い方がまったく異なる独特の演算子です。</p>
<pre class="aya">request
{
    _i = 1
    foo(&amp;_i)
}

foo
{
    _argv[0] = 100
}</pre>
<p>関数呼び出しの際に引数として変数を与える場合、その先頭に&amp;を書くことができます。
先頭に&amp;を付けられた変数は、呼び出し先関数の_argvの対応する要素へ関連付けられます。すなわち、_argvを書き換えると、対応する呼び出し元の変数の値も書き換わるようになります。<br />
上の例では、fooを実行すると _i の値が100に書き換わります。
フィードバック演算子は好きな位置にいくつでも使用可能です。</p>
<pre class="aya">request
{
    foo(1, 2, &amp;_value, &quot;Hello&quot;, &amp;_value2)
    
    _value + _value2
}

foo
{
    _argv[2] = _argv[0] + _argv[1]
    _argv[4] = _argv[3] + &quot; World&quot;
}</pre>
<p>関数requestは &quot;3Hello World&quot; を出力します。
当然のことですが、フィードバック演算子は変数にしか付けられません。</p>
<hr class="full_hr" />
<ul class="navi">
 <li class="navi_left"><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/3.%E5%80%A4%E3%81%A8%E5%A4%89%E6%95%B0" title="マニュアル/文法/3.値と変数" class="link_page_passage">Prev</a><br /><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/3.%E5%80%A4%E3%81%A8%E5%A4%89%E6%95%B0" class="link_page_passage">マニュアル/文法/3.値と変数</a></li>
 <li class="navi_right"><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/5.%E9%85%8D%E5%88%97" title="マニュアル/文法/5.配列" class="link_page_passage">Next</a><br /><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/5.%E9%85%8D%E5%88%97" class="link_page_passage">マニュアル/文法/5.配列</a></li>
 <li class="navi_none"><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95" title="マニュアル/文法" class="link_page_passage">Home</a><br /><a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95" title="マニュアル/文法" class="link_page_passage">Up</a></li>
</ul>
   
   	 	
	</div>
</div>




<table cellspacing=0 width=100%>
<tr><td id=footer>


<div id="lastmodified">
 Last modified on: 2008-03-23 (Sunday) 17:14:24<span class="page_passage"></span></div>


<div id="related">
 Related pages: <a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/3.%E5%80%A4%E3%81%A8%E5%A4%89%E6%95%B0">マニュアル/文法/3.値と変数</a><span class="page_passage"></span>
 <a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95/5.%E9%85%8D%E5%88%97">マニュアル/文法/5.配列</a><span class="page_passage"></span>
 <a href="index.php?%E3%83%9E%E3%83%8B%E3%83%A5%E3%82%A2%E3%83%AB/%E6%96%87%E6%B3%95">マニュアル/文法</a><span class="page_passage"></span></div>


</td></tr>
</table>

<div id="interface_footer"></div>

<script src="interface.js"></script>

</body>
</html>
